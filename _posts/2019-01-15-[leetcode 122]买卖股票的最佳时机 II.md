---
layout: post
title: "[leetcode 122] 买卖股票的最佳时机II"
date: 2019-01-15
author: LiamHsia
category: 算法 leetcode
finished: true
---

### Problem

给定一个数组，它的第 *i* 个元素是一支给定股票第 *i* 天的价格。

设计一个算法来计算你所能获取的最大利润。你可以尽可能地完成更多的交易（多次买卖一支股票）。

**注意：**你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。

**示例 1:**

```
输入: [7,1,5,3,6,4]
输出: 7
解释: 在第 2 天（股票价格 = 1）的时候买入，在第 3 天（股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。
     随后，在第 4 天（股票价格 = 3）的时候买入，在第 5 天（股票价格 = 6）的时候卖出, 这笔交易所能获得利润 = 6-3 = 3 。
```

**示例 2:**

```
输入: [1,2,3,4,5]
输出: 4
解释: 在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。
     注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。
     因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。
```

**示例 3:**

```
输入: [7,6,4,3,1]
输出: 0
解释: 在这种情况下, 没有交易完成, 所以最大利润为 0。
```



### Solution

![](http://liam-images.oss-cn-shanghai.aliyuncs.com/2019-01-15-111953.png)

时间复杂度为O(N^2)的暴力法在此不再赘述。将股票的价格，以图的形式表现出来，形成上面的价格走势图，通过上图我们可以发现，最大利润为每段最大利润之和，也就是红线表示的部分，那么如何计算每段最大利润呢？即峰顶值减去谷底值，如何确定这两个值可以参见[山脉数组的峰顶索引](http://www.blue7wings.com/%E7%AE%97%E6%B3%95%20leetcode/leetcode-852-%E5%B1%B1%E8%84%89%E6%95%B0%E7%BB%84%E7%9A%84%E5%B3%B0%E9%A1%B6%E7%B4%A2%E5%BC%95.html)。

此外，我们还可以用另一种方式实现峰顶和谷底的差值：在上坡的每两点差值之和，以第二段红线为例：

`8 - 2 = (3 - 2) + (5 - 3) + (8 - 5)`

所以问题就转换为两个条件：

1. 是不是在上坡？(右边的值 > 左边的值)
2. 和是多少？

代码如下，时间复杂度O(N)

```go
func maxProfit(prices []int) int {
	length := len(prices)
	sumProfit := 0

	if length < 2 {
		return sumProfit
	}

	for i := 1; i < length; i++ {
		if prices[i] > prices[i-1] {
			profit := prices[i] - prices[i-1]
			sumProfit = sumProfit + profit
		}
	}

	return sumProfit
}
```

